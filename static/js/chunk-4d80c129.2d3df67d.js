(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4d80c129"],{3408:function(t,e,i){},"557f":function(t,e,i){"use strict";i("3408")},f74b:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("el-row",[i("el-select",{staticStyle:{"min-width":"300px"},attrs:{placeholder:"请选择仓库",filterable:!0},on:{change:t.changeRepos},model:{value:t.activeRepos,callback:function(e){t.activeRepos=e},expression:"activeRepos"}},t._l(t.reposList,(function(t){return i("el-option",{key:t.id,attrs:{label:t.name,value:t.name}})})),1),i("el-cascader",{key:t.resourceShow,staticStyle:{"min-width":"450px"},attrs:{placeholder:"请选择目录",options:t.pathArr,props:t.pathProps,disabled:!t.activeRepos},model:{value:t.activePath,callback:function(e){t.activePath=e},expression:"activePath"}}),i("el-button",{attrs:{type:"primary",size:"medium",icon:"el-icon-search",disabled:!t.activeRepos},on:{click:t.search}},[t._v("查询")]),i("el-switch",{attrs:{"active-text":"CDN","inactive-text":"源站",disabled:!t.activeRepos},model:{value:t.isCDN,callback:function(e){t.isCDN=e},expression:"isCDN"}}),i("el-button",{staticClass:"right-item",attrs:{type:"primary",size:"medium",icon:"el-icon-upload",disabled:!t.activeRepos},on:{click:function(e){t.isDrawerShow=!t.isDrawerShow}}},[t._v("上传")])],1),t.hintShow1?i("el-alert",{attrs:{title:"只显示<img>标签支持的 apng,avif,bmp,gif,ico,cur,jpg,jpeg,jfif,pjpeg,pjp,png,svg,tif,tiff,webp 格式的图片，见 https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/img",type:"warning","show-icon":"","close-text":"不再提示"},on:{close:function(e){return t.noDisplay(1)}}}):t._e(),t.hintShow2?i("el-alert",{attrs:{title:"仅支持获取1000个文件内的目录，超出则将请求失败",type:"warning","show-icon":"","close-text":"不再提示"},on:{close:function(e){return t.noDisplay(2)}}}):t._e(),t.hintShow3?i("el-alert",{attrs:{title:"不可上传同名文件，否则将收到422错误码，如需替换，请先删除原文件",type:"warning","show-icon":"","close-text":"不再提示"},on:{close:function(e){return t.noDisplay(3)}}}):t._e(),i("el-row",{directives:[{name:"viewer",rawName:"v-viewer"}]},t._l(t.fileList,(function(e,a){return i("div",{key:a,staticClass:"image-container"},[i("el-image",{attrs:{src:t.imgUrl(e),fit:"scale-down"}}),i("div",{staticClass:"image-content"},[i("div",{staticClass:"info"},[i("span",[t._v(t._s(e.name))])]),i("div",{staticClass:"icons"},[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制CDN链接",placement:"bottom"}},[i("i",{staticClass:"icon el-icon-link",on:{click:function(i){return t.copy(1,e)}}})]),i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"复制MD格式",placement:"bottom"}},[i("SvgIcon",{attrs:{"icon-class":"markdown","class-name":"icon"},on:{click:function(i){return t.copy(2,e)}}})],1),i("i",{staticClass:"icon el-icon-delete",on:{click:function(i){return t.delFile(e)}}})],1)])],1)})),0),i("el-drawer",{attrs:{title:"上传文件",visible:t.isDrawerShow,direction:"rtl",size:"40%",wrapperClosable:!1,"close-on-press-escape":!1},on:{"update:visible":function(e){t.isDrawerShow=e}}},[i("el-row",[i("el-radio",{attrs:{label:"1"},model:{value:t.nameType,callback:function(e){t.nameType=e},expression:"nameType"}},[t._v("使用源文件名")]),i("el-radio",{attrs:{label:"2"},model:{value:t.nameType,callback:function(e){t.nameType=e},expression:"nameType"}},[t._v("使用UUID文件名")]),i("el-button",{directives:[{name:"throttle",rawName:"v-throttle",value:[t.submitUpload,"click",3e3],expression:"[submitUpload,`click`,3000]"}],attrs:{size:"small",type:"primary",icon:"el-icon-upload"}},[t._v("确定上传")])],1),i("el-row",[t._v(" 当前目录："+t._s(t.realPath)+" ")]),i("el-row",[i("el-switch",{attrs:{"active-text":"自定义目录"},model:{value:t.isCustomPath,callback:function(e){t.isCustomPath=e},expression:"isCustomPath"}}),i("el-input",{staticStyle:{"margin-top":"10px"},attrs:{placeholder:"例：oldFolder/newFolder/",disabled:!t.isCustomPath,size:"medium"},model:{value:t.customPath,callback:function(e){t.customPath=e},expression:"customPath"}})],1),i("el-upload",{ref:"uploadRef",attrs:{action:"","http-request":t.upload,drag:"",multiple:"","file-list":t.uploadList,"list-type":"picture","auto-upload":!1}},[i("i",{staticClass:"el-icon-upload"}),i("div",{staticClass:"el-upload__text"},[t._v("将文件拖到此处，或"),i("em",[t._v("点击上传")])])])],1)],1)},n=[],s=i("1da1"),o=(i("96cf"),i("a15b"),i("99af"),i("d3b7"),i("159b"),i("b0c0"),i("ac1f"),i("841c"),i("1276"),i("c00a")),c=i("c9f7"),r=i("61f7"),l=i("4e29"),u=i("c7d5"),h=i("5166"),p={name:"Manage",components:{SvgIcon:o["a"]},data:function(){var t=this;return{reposList:[],pathArr:[{value:"",label:"根目录"}],activeRepos:"",activePath:[""],pathProps:{lazy:!0,checkStrictly:!0,lazyLoad:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(i,a){var n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=i.path.join("/"),s=[],e.next=4,t.getReposContents(s,n);case 4:a(s);case 5:case"end":return e.stop()}}),e)})));function i(t,i){return e.apply(this,arguments)}return i}()},hintShow1:!0,hintShow2:!0,hintShow3:!0,fileList:[],resourceShow:0,isDrawerShow:!1,nameType:"1",uploadList:[],isCDN:!0,isCustomPath:!1,customPath:""}},computed:{realPath:function(){return this.isCustomPath?"/".concat(this.userInfo.login,"/").concat(this.activeRepos,"/").concat(this.customPath):"/".concat(this.userInfo.login,"/").concat(this.activeRepos).concat(this.activePath.join("/"),"/")}},created:function(){this.hintShow1=!localStorage.getItem("hintShow1"),this.hintShow2=!localStorage.getItem("hintShow2"),this.hintShow3=!localStorage.getItem("hintShow3");var t=localStorage.getItem("githubToken"),e=localStorage.getItem("githubUserInfo");t&&e?(this.userInfo=JSON.parse(e),this.getRepos()):(this.msgError("请先配置Token"),this.$router.push("/setting"))},methods:{getRepos:function(){var t=this;Object(c["d"])(this.userInfo.login).then((function(e){t.reposList=e}))},changeRepos:function(){this.resourceShow++,this.activePath=[""],this.fileList=[]},getReposContents:function(t,e){var i=this;return Object(s["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["b"])(i.userInfo.login,i.activeRepos,e).then((function(e){e.forEach((function(e){"dir"===e.type&&t.push({value:e.name,label:e.name,leaf:!1})}))}));case 2:case"end":return a.stop()}}),a)})))()},search:function(){var t=this;this.fileList=[];var e=this.activePath.join("/");Object(c["b"])(this.userInfo.login,this.activeRepos,e).then((function(e){e.forEach((function(e){"file"===e.type&&Object(r["b"])(e.name)&&t.fileList.push(e)}))}))},noDisplay:function(t){localStorage.setItem("hintShow".concat(t),"1")},imgUrl:function(t){return this.isCDN?"https://java.xxfatai.tk/image/".concat(t.path):t.download_url},copy:function(t,e){var i="https://java.xxfatai.tk/image/".concat(e.path),a=i;2==t&&(a="![".concat(e.name,"](").concat(i,")")),Object(u["a"])(a),this.msgSuccess("复制成功")},delFile:function(t){var e=this;this.$confirm("此操作将永久删除该文件, 是否删除?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){var i={message:"Delete file via PictureHosting",sha:t.sha};Object(c["a"])(e.userInfo.login,e.activeRepos,t.path,i).then((function(){e.msgSuccess("删除成功"),e.search()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},submitUpload:function(){this.uploadList=this.$refs.uploadRef.uploadFiles,this.uploadList.length?this.$refs.uploadRef.submit():this.msgError("请先选择文件")},upload:function(t){var e=this,i=new FileReader;i.readAsDataURL(t.file),i.onload=function(){var a=i.result.split(",")[1],n=t.file.name;"2"===e.nameType&&(n=Object(l["a"])()+n.substr(n.lastIndexOf("."))),Object(h["a"])((function(){return e.push2Github(t,n,a)}),1e3)}},push2Github:function(t,e,i){var a=this,n={message:"Add files via PictureHosting",content:i},s=this.activePath.join("/");this.isCustomPath&&("/"===this.customPath?s="":(s=this.customPath,"/"!==s.charAt(0)&&(s="/"+s),"/"===s.charAt(s.length-1)&&(s=s.substring(0,s.length-1)))),s+="/image",Object(c["e"])(this.userInfo.login,this.activeRepos,s,e,n).then((function(){a.msgSuccess("上传成功"),t.onSuccess()}))}}},f=p,m=(i("557f"),i("f9bc"),i("2877")),d=Object(m["a"])(f,a,n,!1,null,"424284ac",null);e["default"]=d.exports},f9bc:function(t,e,i){"use strict";i("fed3")},fed3:function(t,e,i){}}]);